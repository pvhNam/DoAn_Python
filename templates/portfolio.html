{% extends "base.html" %}
{% block title %}Danh mục đầu tư{% endblock %}
{% block content %}
<h2 class="mb-3">Danh mục đầu tư</h2>
<div class="alert alert-success">
    Tổng tài sản ước tính: <strong>{{ "{:,.0f}".format(total_asset) }} VNĐ</strong>
</div>

<table class="table table-bordered text-center align-middle">
    <thead class="table-secondary">
        <tr>
            <th>Mã</th>
            <th>Khối lượng</th>
            <th>Giá vốn</th>
            <th>Giá thị trường</th>
            <th>Lãi/Lỗ</th>
            <th>%</th>
            <th>Hành động</th>
        </tr>
    </thead>
    <tbody>
        {% for item in portfolio %}
        <tr>
            <td class="fw-bold">{{ item.symbol }}</td>
            <td>{{ "{:,}".format(item.quantity) }}</td>
            <td>{{ "{:,.0f}".format(item.avg_price) }}</td>
            <td>{{ "{:,.0f}".format(item.current_price) }}</td>
            <td class="{{ 'text-success' if item.profit > 0 else 'text-danger' }}">
                {{ "{:,.0f}".format(item.profit) }}
            </td>
            <td class="{{ 'text-success' if item.percent > 0 else 'text-danger' }}">
                {{ "{:.2f}".format(item.percent) }}%
            </td>
            <td>
                <a href="{{ url_for('market.stock_detail', symbol=item.symbol) }}" class="btn btn-sm btn-primary">Giao dịch</a>
            </td>
        </tr>
        {% endfor %}
        {% if not portfolio %}
        <tr>
            <td colspan="7" class="text-muted">Bạn chưa nắm giữ cổ phiếu nào.</td>
        </tr>
        {% endif %}
    </tbody>
</table>
{% endblock %}